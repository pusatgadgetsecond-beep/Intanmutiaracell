<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Intan Mutiara Cell - Marketplace</title>
  <style>
    body{font-family:'Poppins',sans-serif;background:#f9fafb;margin:0;}
    header{background:#1e40af;color:#fff;padding:15px;position:sticky;top:0;z-index:1000;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;}
    header .profile{display:flex;align-items:center;gap:12px;}
    header img{width:45px;height:45px;border-radius:50%;border:2px solid #fff;}
    header h1{margin:0;font-size:1.3rem;}
    .search-bar{flex:1;min-width:180px;margin:10px;}
    .search-bar input{width:100%;padding:10px;border-radius:8px;border:none;font-size:1rem;}
    .market-links a{margin-left:10px;text-decoration:none;padding:8px 12px;border-radius:8px;color:#fff;font-weight:600;}
    .market-links .shopee{background:#f97316;}
    .market-links .tokopedia{background:#16a34a;}

    .banner{width:100%;height:220px;overflow:hidden;}
    .banner img{width:100%;height:100%;object-fit:cover;}

    /* Kategori */
    .kategori-container {padding:20px;background:#fff;margin-top:10px;}
    .kategori-title {font-size:18px;font-weight:600;margin-bottom:15px;display:flex;justify-content:space-between;align-items:center;}
    .lihat-semua {font-size:14px;color:#e11d48;text-decoration:none;}
    .kategori-list {display:flex;gap:20px;overflow-x:auto;padding-bottom:10px;}
    .kategori-item {flex:0 0 auto;text-align:center;cursor:pointer;}
    .kategori-item img {
      width:65px;
      height:65px;
      object-fit:cover;
      border-radius:50%;
      border:2px solid #fff;
      background:#f3f4f6;
      box-shadow:0 2px 6px rgba(0,0,0,0.15);
      transition:transform .2s;
    }
    .kategori-item img:hover {transform:scale(1.08);}
    .kategori-item span {display:block;margin-top:6px;font-size:14px;color:#333;}

    /* Produk Grid */
    main{padding:20px;}
    .product-section h2{margin:10px 0 15px;color:#1e3a8a;}
    .product-grid{
      display:grid;
      gap:15px;
      grid-template-columns:repeat(2,1fr); /* HP = 2 kolom */
    }
    @media (min-width:768px){
      .product-grid{
        grid-template-columns:repeat(5,1fr); /* Tablet/PC = 5 kolom */
      }
    }
    .product-card{
      background:#fff;
      border:1px solid #eee;
      border-radius:12px;
      box-shadow:0 3px 8px rgba(0,0,0,0.05);
      overflow:hidden;
      display:flex;
      flex-direction:column;
    }
    .product-image{position:relative;}
    .product-image img{width:100%;height:180px;object-fit:cover;}
    .badge-cicilan{
      position:absolute;top:8px;left:8px;
      background:#1e40af;color:#fff;
      font-size:0.7rem;padding:3px 6px;border-radius:4px;
    }
    .product-info{padding:10px;flex:1;display:flex;flex-direction:column;}
    .product-title{font-weight:600;font-size:0.9rem;margin-bottom:6px;height:40px;overflow:hidden;}
    .product-price{color:#e11d48;font-weight:700;}
    .product-discount{color:#777;font-size:0.8rem;margin-left:5px;text-decoration:line-through;}
    .product-meta{font-size:0.8rem;color:#555;margin-top:5px;}
    .buy-links{display:flex;gap:6px;margin-top:auto;}
    .buy-links a{flex:1;text-align:center;padding:7px;border-radius:6px;font-weight:600;text-decoration:none;color:#fff;font-size:0.8rem;}
    .buy-links .shopee{background:#f97316;}
    .buy-links .tokopedia{background:#16a34a;}

    /* Pagination */
    .pagination {display:flex;justify-content:center;gap:8px;margin-top:20px;flex-wrap:wrap;}
    .pagination button {
      padding:6px 12px;
      border:none;
      border-radius:6px;
      cursor:pointer;
      background:#e5e7eb;
      font-weight:600;
    }
    .pagination button.active {background:#1e40af;color:#fff;}
    .pagination button:hover {background:#1d4ed8;color:#fff;}

    footer{background:#1e3a8a;color:#fff;padding:30px 20px;margin-top:40px;}
    footer .footer-container{max-width:1200px;margin:auto;display:flex;flex-wrap:wrap;justify-content:space-between;gap:20px;}
    footer h3{margin-bottom:12px;font-size:1.1rem;}
    footer p{margin:0;}
    .follow-wrapper{display:flex;align-items:center;gap:15px;}
    .follow-wrapper h3{margin:0;white-space:nowrap;}
    .social-icons{display:flex;gap:12px;}
    .social-icons a img{width:20px;height:20px;border-radius:50%;background:#fff;padding:6px;box-shadow:0 3px 6px rgba(0,0,0,0.15);transition:.4s;}
    .social-icons a img:hover{transform:scale(1.2);background:#e0e7ff;}
  </style>
</head>
<body>
<header>
  <div class="profile">
    <img src="Intan Mutiara.jpg" alt="Logo Toko">
    <h1>Intan Mutiara Cell</h1>
  </div>
  <div class="search-bar"><input type="text" id="searchInput" placeholder="Cari produk..."></div>
  <div class="market-links">
    <a href="https://shopee.co.id/intanmutiaracell" target="_blank" class="shopee">Shopee</a>
    <a href="https://www.tokopedia.com/intan-mutiara-store" target="_blank" class="tokopedia">Tokopedia</a>
  </div>
</header>

<div class="banner">
  <img src="Intan Mutiara Cell.jpg" alt="Sampul Toko">
</div>

<!-- Kategori -->
<div class="kategori-container">
  <h2 class="kategori-title">Kategori <a href="#" class="lihat-semua">Lihat Semua &gt;</a></h2>
  <div class="kategori-list" id="categoryList"></div>
</div>

<!-- Produk -->
<main>
  <section class="product-section">
    <h2>Kamu Mungkin Suka</h2>
    <div class="product-grid" id="productGrid"></div>
    <div class="pagination" id="pagination"></div>
  </section>
</main>

<!-- Footer -->
<footer>
  <div class="footer-container">
    <div class="follow-wrapper">
      <h3>Follow Kami :</h3>
      <div class="social-icons">
        <a href="https://instagram.com/intanmutiaracell" target="_blank"><img src="https://cdn-icons-png.flaticon.com/512/2111/2111463.png" alt="Instagram"></a>
        <a href="https://tiktok.com/@intanmutiaracell" target="_blank"><img src="https://cdn-icons-png.flaticon.com/512/3046/3046120.png" alt="TikTok"></a>
        <a href="https://youtube.com/@intanmutiaracell" target="_blank"><img src="https://cdn-icons-png.flaticon.com/512/1384/1384060.png" alt="YouTube"></a>
      </div>
    </div>
    <div>
      <h3>Alamat Toko</h3>
      <p>Intan Mutiara, Jl. Pemuda No.27-31, Embong Kaliasin, Kec. Genteng, Surabaya Jawa Timur</p>
      <p>Telp/WA: 0896 - 5342 - 9419</p>
    </div>
  </div>
</footer>

<script>
  const apiURL = "https://script.google.com/macros/s/AKfycbwbJTJV39rv9w3vXetCj7r3yU04uA0txdMrtAyY5ieqEGxHKmQH0KxpOh3SfdBuxKwcsw/exec"; 
  let currentCategory = "All";
  let products = [];
  let currentPage = 1;
  let perPage = window.innerWidth < 768 ? 16 : 40;

  const productGrid = document.getElementById("productGrid");
  const searchInput = document.getElementById("searchInput");
  const categoryList = document.getElementById("categoryList");
  const pagination = document.getElementById("pagination");

  const logoMap = {
    "All": "logo/all.png",
    "iPhone": "logo/iPhone.png",
    "Oppo": "logo/Oppo.png",
    "Vivo": "logo/Vivo.png",
    "Samsung": "logo/Samsung.png",
    "Xiaomi": "logo/Xiaomi.png",
    "Realme": "logo/Realme.png",
    "Infinix": "logo/Infinix.png",
    "Tecno": "logo/Tecno.png",
    "iTel": "logo/itel.png",
    "Nokia": "logo/Nokia.png",
    "ZTE": "logo/zte.png",
    "Asus": "logo/asus.png",
    "Huawei": "logo/huawei.png",
  };

  async function fetchProducts() {
    try {
      const res = await fetch(apiURL);
      const data = await res.json();
      products = data;
      generateCategories();
      renderProducts();
    } catch (err) {
      productGrid.innerHTML = "<p>Gagal memuat produk. Periksa koneksi atau API!</p>";
      console.error(err);
    }
  }

  function generateCategories() {
    categoryList.innerHTML = "";
    const categories = ["All", ...new Set(products.map(p => p.category))];
    categories.forEach(cat => {
      let item = document.createElement("div");
      item.className = "kategori-item";
      let logo = logoMap[cat] || "logo/default.jpg";
      item.innerHTML = `<img src="${logo}" alt="${cat}"><span>${cat}</span>`;
      item.addEventListener("click", () => {
        currentCategory = cat;
        currentPage = 1;
        renderProducts(searchInput.value);
      });
      categoryList.appendChild(item);
    });
  }

  function renderProducts(keyword = "") {
    productGrid.innerHTML = "";
    let filtered = products.filter(p =>
      p.title.toLowerCase().includes(keyword.toLowerCase()) &&
      (currentCategory === "All" || p.category === currentCategory)
    );

    if (filtered.length === 0) {
      productGrid.innerHTML = "<p>Produk tidak ditemukan.</p>";
      pagination.innerHTML = "";
      return;
    }

    let totalPages = Math.ceil(filtered.length / perPage);
    let start = (currentPage - 1) * perPage;
    let end = start + perPage;
    let paginated = filtered.slice(start, end);

    paginated.forEach(p => {
      let card = document.createElement("div");
      card.className = "product-card";
      card.innerHTML = `
        <div class="product-image">
          <img src="${p.image}" alt="${p.title}">
          <span class="badge-cicilan">Cicilan 0%</span>
        </div>
        <div class="product-info">
          <div class="product-title">${p.title}</div>
          <div>
            <span class="product-price">${p.price}</span>
            ${p.discount ? `<span class="product-discount">${p.discount}</span>` : ""}
          </div>
          <div class="product-meta">‚≠ê ${p.rating || "4.8"} | Terjual ${p.sold || "100+"}</div>
          <div class="buy-links">
            <a href="${p.shopee}" target="_blank" class="shopee">Shopee</a>
            <a href="${p.tokopedia}" target="_blank" class="tokopedia">Tokopedia</a>
          </div>
        </div>
      `;
      productGrid.appendChild(card);
    });

    pagination.innerHTML = "";
    if (currentPage > 1) {
      let prevBtn = document.createElement("button");
      prevBtn.textContent = "<";
      prevBtn.addEventListener("click", () => {
        currentPage--;
        renderProducts(searchInput.value);
      });
      pagination.appendChild(prevBtn);
    }
    for (let i = 1; i <= totalPages; i++) {
      if (i === 1 || i === totalPages || (i >= currentPage - 2 && i <= currentPage + 2)) {
        let btn = document.createElement("button");
        btn.textContent = i;
        if (i === currentPage) btn.classList.add("active");
        btn.addEventListener("click", () => {
          currentPage = i;
          renderProducts(searchInput.value);
        });
        pagination.appendChild(btn);
      } else if (
        (i === currentPage - 3 && currentPage > 4) ||
        (i === currentPage + 3 && currentPage < totalPages - 3)
      ) {
        let dots = document.createElement("span");
        dots.textContent = "...";
        dots.style.padding = "6px 10px";
        pagination.appendChild(dots);
      }
    }
    if (currentPage < totalPages) {
      let nextBtn = document.createElement("button");
      nextBtn.textContent = ">";
      nextBtn.addEventListener("click", () => {
        currentPage++;
        renderProducts(searchInput.value);
      });
      pagination.appendChild(nextBtn);
    }
  }

  searchInput.addEventListener("input", () => {
    currentPage = 1;
    renderProducts(searchInput.value);
  });

  window.addEventListener("resize", () => {
    perPage = window.innerWidth < 768 ? 16 : 40;
    currentPage = 1;
    renderProducts(searchInput.value);
  });

  fetchProducts();
</script>
</body>
</html>
